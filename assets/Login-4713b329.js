import{r as Z,f as _e,s as Se,c as D,n as A,t as F,h as G,B as Te,j as M,m as Be,a as U,k as xe,b as Re,l as Ie,o as $e,p as Ve,q as pe,v as Ae,x as ne,y as Pe,z as ae,A as Ne,C as le,e as ze,u as Le,d as Oe,D as qe,w as K}from"./index-0a3a7c41.js";import{u as Ue,S as Ee,T as Fe}from"./index-7917544c.js";import{S as De,a as We}from"./index-0b14e208.js";import{u as ce,i as He,F as Me}from"./request-1e91a24a.js";import{s as je,a as oe,r as Ze,b as Ge,C as Ke,B as Xe,F as Ye}from"./index-73a6fcfc.js";import{c as Je,N as Qe}from"./index-c0a36645.js";import{r as S,q as et,d as N,a as I,c as s,s as p,v as tt,x as nt,y as V,z as at,m as lt,A as ot,B as rt,C as st,b as it,w as T,u as k,i as ct,o as ut,k as re,D as dt,E as ft,G as vt}from"./index-e0a5d4f9.js";import{B as mt,a as bt,r as ht}from"./use-route-7ba8dcd2.js";import{u as X,o as gt}from"./use-touch-7abbf770.js";function yt(e,a,u){let f=0;const l=e.scrollLeft,b=u===0?1:Math.round(u*1e3/16);function i(){e.scrollLeft+=(a-l)/b,++f<b&&Z(i)}i()}function wt(e,a,u,f){let l=_e(e);const b=l<a,i=u===0?1:Math.round(u*1e3/16),m=(a-l)/i;function n(){l+=m,(b&&l>a||!b&&l<a)&&(l=a),Se(e,l),b&&l<a||!b&&l>a?Z(n):f&&Z(f)}n()}function kt(){const e=S([]),a=[];return et(()=>{e.value=[]}),[e,f=>(a[f]||(a[f]=l=>{e.value[f]=l}),a[f])]}const[Ct,se]=D("tab");var _t=N({name:Ct,props:{id:String,dot:Boolean,type:String,color:String,title:String,badge:A,shrink:Boolean,isActive:Boolean,disabled:Boolean,controls:String,scrollable:Boolean,activeColor:String,inactiveColor:String,showZeroBadge:F},setup(e,{slots:a}){const u=I(()=>{const l={},{type:b,color:i,disabled:m,isActive:n,activeColor:y,inactiveColor:d}=e;i&&b==="card"&&(l.borderColor=i,m||(n?l.backgroundColor=i:l.color=i));const C=n?y:d;return C&&(l.color=C),l}),f=()=>{const l=s("span",{class:se("text",{ellipsis:!e.scrollable})},[a.title?a.title():e.title]);return e.dot||G(e.badge)&&e.badge!==""?s(Te,{dot:e.dot,content:e.badge,showZero:e.showZeroBadge},{default:()=>[l]}):l};return()=>s("div",{id:e.id,role:"tab",class:[se([e.type,{grow:e.scrollable&&!e.shrink,shrink:e.shrink,active:e.isActive,disabled:e.disabled}])],style:u.value,tabindex:e.disabled?void 0:e.isActive?0:-1,"aria-selected":e.isActive,"aria-disabled":e.disabled||void 0,"aria-controls":e.controls},[f()])}});const[St,ie]=D("tabs");var Tt=N({name:St,props:{count:M(Number),inited:Boolean,animated:Boolean,duration:M(A),swipeable:Boolean,lazyRender:Boolean,currentIndex:M(Number)},emits:["change"],setup(e,{emit:a,slots:u}){const f=S(),l=m=>a("change",m),b=()=>{var m;const n=(m=u.default)==null?void 0:m.call(u);return e.animated||e.swipeable?s(De,{ref:f,loop:!1,class:ie("track"),duration:+e.duration*1e3,touchable:e.swipeable,lazyRender:e.lazyRender,showIndicators:!1,onChange:l},{default:()=>[n]}):n},i=m=>{const n=f.value;n&&n.state.active!==m&&n.swipeTo(m,{immediate:!e.inited})};return p(()=>e.currentIndex,i),tt(()=>{i(e.currentIndex)}),X({swipeRef:f}),()=>s("div",{class:ie("content",{animated:e.animated||e.swipeable})},[b()])}});const[ue,E]=D("tabs"),Bt={type:Be("line"),color:String,border:Boolean,sticky:Boolean,shrink:Boolean,active:U(0),duration:U(.3),animated:Boolean,ellipsis:F,swipeable:Boolean,scrollspy:Boolean,offsetTop:U(0),background:String,lazyRender:F,lineWidth:A,lineHeight:A,beforeChange:Function,swipeThreshold:U(5),titleActiveColor:String,titleInactiveColor:String},de=Symbol(ue);var xt=N({name:ue,props:Bt,emits:["change","scroll","rendered","clickTab","update:active"],setup(e,{emit:a,slots:u}){let f,l,b;const i=S(),m=S(),n=S(),y=S(),d=ce(),w=xe(i),[C,$]=kt(),{children:v,linkChildren:P}=Re(de),r=nt({inited:!1,position:"",lineStyle:{},currentIndex:-1}),z=I(()=>v.length>e.swipeThreshold||!e.ellipsis||e.shrink),W=I(()=>({borderColor:e.color,background:e.background})),x=(t,o)=>{var c;return(c=t.name)!=null?c:o},Y=I(()=>{const t=v[r.currentIndex];if(t)return x(t,r.currentIndex)}),H=I(()=>Ie(e.offsetTop)),J=I(()=>e.sticky?H.value+f:0),L=t=>{const o=m.value,c=C.value;if(!z.value||!o||!c||!c[r.currentIndex])return;const g=c[r.currentIndex].$el,h=g.offsetLeft-(o.offsetWidth-g.offsetWidth)/2;yt(o,h,t?0:+e.duration)},B=()=>{const t=r.inited;V(()=>{const o=C.value;if(!o||!o[r.currentIndex]||e.type!=="line"||Ae(i.value))return;const c=o[r.currentIndex].$el,{lineWidth:g,lineHeight:h}=e,_=c.offsetLeft+c.offsetWidth/2,R={width:ne(g),backgroundColor:e.color,transform:`translateX(${_}px) translateX(-50%)`};if(t&&(R.transitionDuration=`${e.duration}s`),G(h)){const te=ne(h);R.height=te,R.borderRadius=te}r.lineStyle=R})},fe=t=>{const o=t<r.currentIndex?-1:1;for(;t>=0&&t<v.length;){if(!v[t].disabled)return t;t+=o}},O=(t,o)=>{const c=fe(t);if(!G(c))return;const g=v[c],h=x(g,c),_=r.currentIndex!==null;r.currentIndex!==c&&(r.currentIndex=c,o||L(),B()),h!==e.active&&(a("update:active",h),_&&a("change",h,g.title)),b&&!e.scrollspy&&Pe(Math.ceil(ae(i.value)-H.value))},q=(t,o)=>{const c=v.find((h,_)=>x(h,_)===t),g=c?v.indexOf(c):0;O(g,o)},Q=(t=!1)=>{if(e.scrollspy){const o=v[r.currentIndex].$el;if(o&&w.value){const c=ae(o,w.value)-J.value;l=!0,wt(w.value,c,t?0:+e.duration,()=>{l=!1})}}},ve=(t,o,c)=>{const{title:g,disabled:h}=v[o],_=x(v[o],o);h||(Je(e.beforeChange,{args:[_],done:()=>{O(o),Q()}}),bt(t)),a("clickTab",{name:_,title:g,event:c,disabled:h})},me=t=>{b=t.isFixed,a("scroll",t)},be=t=>{V(()=>{q(t),Q(!0)})},he=()=>{for(let t=0;t<v.length;t++){const{top:o}=le(v[t].$el);if(o>J.value)return t===0?0:t-1}return v.length-1},ge=()=>{if(e.scrollspy&&!l){const t=he();O(t)}},ye=()=>v.map((t,o)=>s(_t,lt({key:t.id,id:`${d}-${o}`,ref:$(o),type:e.type,color:e.color,style:t.titleStyle,class:t.titleClass,shrink:e.shrink,isActive:o===r.currentIndex,controls:t.id,scrollable:z.value,activeColor:e.titleActiveColor,inactiveColor:e.titleInactiveColor,onClick:c=>ve(t,o,c)},Ne(t,["dot","badge","title","disabled","showZeroBadge"])),{title:t.$slots.title})),we=()=>{if(e.type==="line"&&v.length)return s("div",{class:E("line"),style:r.lineStyle},null)},ee=()=>{var t,o,c;const{type:g,border:h,sticky:_}=e,R=[s("div",{ref:_?void 0:n,class:[E("wrap"),{[mt]:g==="line"&&h}]},[s("div",{ref:m,role:"tablist",class:E("nav",[g,{shrink:e.shrink,complete:z.value}]),style:W.value,"aria-orientation":"horizontal"},[(t=u["nav-left"])==null?void 0:t.call(u),ye(),we(),(o=u["nav-right"])==null?void 0:o.call(u)])]),(c=u["nav-bottom"])==null?void 0:c.call(u)];return _?s("div",{ref:n},[R]):R};p([()=>e.color,$e],B),p(()=>e.active,t=>{t!==Y.value&&q(t)}),p(()=>v.length,()=>{r.inited&&(q(e.active),B(),V(()=>{L(!0)}))});const ke=()=>{q(e.active,!0),V(()=>{r.inited=!0,n.value&&(f=le(n.value).height),L(!0)})},Ce=(t,o)=>a("rendered",t,o);return X({resize:()=>{B(),V(()=>{var t,o;return(o=(t=y.value)==null?void 0:t.swipeRef.value)==null?void 0:o.resize()})},scrollTo:be}),at(B),gt(B),Ve(ke),Ue(i,B),pe("scroll",ge,{target:w,passive:!0}),P({id:d,props:e,setLine:B,onRendered:Ce,currentName:Y,scrollIntoView:L}),()=>s("div",{ref:i,class:E([e.type])},[e.sticky?s(Ee,{container:i.value,offsetTop:H.value,onScroll:me},{default:()=>[ee()]}):ee(),s(Tt,{ref:y,count:v.length,inited:r.inited,animated:e.animated,duration:e.duration,swipeable:e.swipeable,lazyRender:e.lazyRender,currentIndex:r.currentIndex,onChange:O},{default:()=>{var t;return[(t=u.default)==null?void 0:t.call(u)]}})])}});const[Rt,j]=D("tab"),It=ze({},ht,{dot:Boolean,name:A,badge:A,title:String,disabled:Boolean,titleClass:Le,titleStyle:[String,Object],showZeroBadge:F});var $t=N({name:Rt,props:It,setup(e,{slots:a}){const u=ce(),f=S(!1),{parent:l,index:b}=Oe(de);if(!l)return;const i=()=>{var d;return(d=e.name)!=null?d:b.value},m=()=>{f.value=!0,l.props.lazyRender&&V(()=>{l.onRendered(i(),e.title)})},n=I(()=>{const d=i()===l.currentName.value;return d&&!f.value&&m(),d}),y=S(!n.value);return p(n,d=>{d?y.value=!1:qe(()=>{y.value=!0})}),p(()=>e.title,()=>{l.setLine(),l.scrollIntoView()}),ot(Fe,n),()=>{var d;const w=`${l.id}-${b.value}`,{animated:C,swipeable:$,scrollspy:v,lazyRender:P}=l.props;if(!a.default&&!C)return;const r=v||n.value;if(C||$)return s(We,{id:u,role:"tabpanel",class:j("panel-wrapper",{inactive:y.value}),tabindex:n.value?0:-1,"aria-hidden":!n.value,"aria-labelledby":w},{default:()=>{var x;return[s("div",{class:j("panel")},[(x=a.default)==null?void 0:x.call(a)])]}});const W=f.value||v||!P?(d=a.default)==null?void 0:d.call(a):null;return X({id:u}),rt(s("div",{id:u,role:"tabpanel",class:j("panel"),tabindex:r?0:-1,"aria-labelledby":w},[W]),[[st,r]])}}});const Vt=K($t),pt=K(xt);K(je);const At=e=>He.post("/auth/login",e),Wt=N({__name:"Login",setup(e){const a=S({username:"",password:"",nickname:"",school:""}),u=async m=>{try{const n=await At(m);dt().$patch(d=>{d.token=n.token,d.user=n.user}),b()}catch(n){n.status?oe(`${n.message}
错误代码
${n.status}`):oe("登录失败,请检查账号密码!")}},f=async m=>{const n=Object.entries(m).filter(([d,w])=>w),y=Object.fromEntries(n);await Ze(y),Ge("注册成功"),i.value=0},l=ft();vt();const b=()=>{l.back()},i=S(0);return(m,n)=>{const y=Qe,d=Me,w=Ke,C=Xe,$=Ye,v=Vt,P=pt;return ut(),it("div",null,[s(y,{title:"开启新大陆","left-text":"返回","left-arrow":"",onClickLeft:b}),s(P,{active:k(i),"onUpdate:active":n[6]||(n[6]=r=>ct(i)?i.value=r:null)},{default:T(()=>[s(v,{title:"登录"},{default:T(()=>[s($,{onSubmit:u},{default:T(()=>[s(w,{inset:""},{default:T(()=>[s(d,{modelValue:k(a).username,"onUpdate:modelValue":n[0]||(n[0]=r=>k(a).username=r),name:"username",label:"用户名",placeholder:"它是你的唯一凭证",rules:[{required:!0,message:"请填写用户名"}],required:""},null,8,["modelValue"]),s(d,{modelValue:k(a).password,"onUpdate:modelValue":n[1]||(n[1]=r=>k(a).password=r),type:"password",name:"password",label:"密码",placeholder:"你可以通过特殊手段找回它",rules:[{required:!0,message:"请填写密码"}],required:""},null,8,["modelValue"])]),_:1}),s(C,{round:"",block:"",type:"primary","native-type":"submit"},{default:T(()=>[re(" 登录 ")]),_:1})]),_:1})]),_:1}),s(v,{title:"注册"},{default:T(()=>[s($,{onSubmit:f},{default:T(()=>[s(w,{inset:""},{default:T(()=>[s(d,{modelValue:k(a).username,"onUpdate:modelValue":n[2]||(n[2]=r=>k(a).username=r),name:"username",label:"用户名",placeholder:"它是你的唯一凭证",rules:[{required:!0,message:"请填写用户名"}],required:""},null,8,["modelValue"]),s(d,{modelValue:k(a).password,"onUpdate:modelValue":n[3]||(n[3]=r=>k(a).password=r),type:"password",name:"password",label:"密码",placeholder:"你可以通过特殊手段找回它",rules:[{required:!0,message:"请填写密码"}],required:""},null,8,["modelValue"]),s(d,{modelValue:k(a).nickname,"onUpdate:modelValue":n[4]||(n[4]=r=>k(a).nickname=r),name:"nickname",label:"昵称",placeholder:"我该怎么称呼您"},null,8,["modelValue"]),s(d,{modelValue:k(a).school,"onUpdate:modelValue":n[5]||(n[5]=r=>k(a).school=r),name:"school",label:"学校",placeholder:"我无从校验，请您确保它的真实性"},null,8,["modelValue"])]),_:1}),s(C,{round:"",block:"",type:"primary","native-type":"submit"},{default:T(()=>[re(" 注册 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["active"])])}}});export{Wt as default};
